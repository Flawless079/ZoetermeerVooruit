{% extends '@Main/base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('bundles/main/css/button.css') }}">
{% endblock %}

{% for question in questions %}
    {% for choice in choices if choice.questionId == question.id %}
        {% for answer in answers %}
            {% if answer.choiceId == choice.id %}
                {% set show = false %}
            {% endif %}
        {% endfor %}
    {% endfor %}
{% endfor %}

{% block body %}
    {% if is_granted ('ROLE_ADMIN') %}
    <h1>Enquete</h1>

    <table class="table table-striped">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ enquete.id }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td>{{ enquete.title }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ enquete.description }}</td>
            </tr>
            <tr>
                <th>Startdate</th>
                <td>{% if enquete.startDate %}{{ enquete.startDate|date('Y-m-d H:i:s') }}{% endif %}</td>
            </tr>
            <tr>
                <th>Enddate</th>
                <td>{% if enquete.endDate %}{{ enquete.endDate|date('Y-m-d H:i:s') }}{% endif %}</td>
            </tr>
            <tr>
                <th>Published</th>
                <td>{{ enquete.published }}</td>
            </tr>
        </tbody>
    </table>
        <a id="button" class="btn btn-default" href="{{ path('enquete_index') }}">Terug naar overzicht</a>

        <a id="button" class="btn btn-primary" href="{{ path('enquete_edit', { 'id': enquete.id }) }}">Wijzigen</a>

        {{ form_start(delete_form) }}
            <input id="button" class="btn btn-danger" type="submit" value="Verwijderen">
        {{ form_end(delete_form) }}

    {% elseif app.user %}
        {% if show == true %}
            <div class="col-sm-6">
                <hr>
            <h2>{{ enquete.title }}</h2>
            <p>{{ enquete.description }}</p>
                <form name="enquete-{{ enquete.id }}" method="post">
                    {% for question in questions %}
                        <hr>
                        <p><b>{{ question.title }}</b></p>
                        {% for choice in choices if choice.questionId == question.id %}
                            <div class="radio">
                                <label><input type="radio" name="radio-{{ loop.parent.loop.index }}" value="{{ choice.id }}">{{ choice.choice }}</label>
                            </div>
                        {% endfor %}

                    {% endfor %}
                        <hr>
                        <input class="btn btn-success" type="submit" value="Versturen" style="margin-bottom: 20px">
                </form>
            </div>
        {% else %}
        <h1>NIKS</h1>
        {% endif %}
    {% else %}
        <div>
            <h3>Helaas, u kunt deze pagina niet bekijken.</h3>
            <p>Log in als Administrator om de pagina weer te geven.</p>
        </div>
    {% endif %}
{% endblock %}
